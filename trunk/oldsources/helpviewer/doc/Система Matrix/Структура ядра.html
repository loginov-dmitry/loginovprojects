<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<TITLE> Структура ядра </TITLE>
<META NAME="Generator" CONTENT="EditPlus">
<META NAME="Author" CONTENT="Логинов Д.С.">
<META NAME="Keywords" CONTENT="Matrix">
<META NAME="Description" CONTENT="Структура ядра">
</HEAD>

<BODY>
<H1 align=center><I>Структура ядра Matrix</I></H1>
<font style="font-family: courier new;"><I>
<P>Основу ядра <B>Matrix</B> составляет класс <B>TWorkspace</B> (Workspace - рабочая область). Помимо того, что в рабочей области хранятся все массивы, класс <B>TWorkspace</B> дает программисту свойства и методы, достаточные для программирования любого вычислительного алгоритма. Сразу после подключения к приложению модуля <B>Matrix</B> программисту доступен объект <B>Base</B>, имеющий тип <B>TWorkspace</B>. Это постоянная рабочая область, которая создается и уничтожается автоматически без вмешательства программиста. Программист может создавать как временные, так и постоянные рабочие области и он должен сам заботится об их уничтожении. Для создания рабочей области служит конструктор <A HREF="../Функции ядра/Create.html"><B>Create()</B></A>, а для уничтожения - метод <A HREF="../Функции ядра/Destroy.html"><B>Free()</B></A>. В случае возникновения ошибки все временные рабочие области уничтожаются, а постоянные рабочие области (например, Base) остаются нетронутыми. Эта возможность есть и в системе MATLAB. Там тоже есть постоянная рабочая область Base, а временные рабочие области создаются автоматически при вызове функции и уничтожаются при выходе из функции.
<P>Методы и свойства класса <B>TWorkspace</B> рассматриваются в разделе справки "Функции ядра", а поля этого класса мы рассмотрим сейчас.
<UL>
<LI><B>wsName: String</B> - имя рабочей области. Оно должно задаваться программистом при создании рабочей области с помощью конструктора <A HREF="../Функции ядра/Create.html"><B>Create()</B></A>. В ходе работы программы изменять это имя программист не должен. Имя рабочей области может представлять собой любой текст.
<LI><B>wsMatrixList: TMatrixList</B> - список массивов данной рабочей области. Для каждого массива хранит имя, число строк, число столбцов и адрес.
<LI><B>wsRefList: TIntList</B> - список индексов массивов, переданных по ссылке. Передачу массивов в подпрограмму можно выполнять как с помощью копирования, так и по ссылке. Второй способ позволяет существенно увеличить скорость работы подпрограммы и уменьшить расходы памяти. Список wsRefList позволяет предотвратить ошибочное уничтожение массива, переданного по ссылке.
<LI><B>ElemCount: Integer</B> - хранит реальное число элементов всех массивов в данной рабочей области. При передаче массива по ссылке значение счетчика ElemCount не изменяется.
<LI><B>UniqueNameCounter: Int64</B>  -  переменная, используемая при генерации уникальных имен массивов. Любая функция (функция ядра или внешняя функция) во время своей работы может создавать массу временных массивов. Временные массивы должны иметь уникальные имена, образуемые с помощью функции <A HREF="../Функции ядра/GenName.html"><B>GenName()</B></A>. Эта функция при каждом вызове увеличивает счетчик <B>UniqueNameCounter</B> на единицу. 
<LI><B>SelfWS</B> - типизированный указатель (ссылка) на данную рабочую область. Позволяет программировать подпрограммы, не объявляя объекта TWorkspace. 
</UL>

<P>В ядре <B>Matrix</B> есть еще один класс: <B>TMatrixCommonFunc</B>. Этот класс реализует методы, которые не вошли в класс <B>TWorkspace</B>. Эти методы программист может использовать в своих целях. Среди них есть, например метод <B>FloatToStrGen()</B>, который преобразует вещественное число в строку, причем разделителем целых и дробных разрядов является точка не зависимо от настроек операционной системы. Вам не нужно создавать объект класса <B>TMatrixCommonFunc</B>, т.к. один объект этого класса уже есть, он называется <B>MatrixFunc</B>.

<P>Кроме того, в ядро <B>Matrix</B> включены константы - сообщения об ошибках. Использование констант позволяет при необходимости быстро локализовать ваш продукт на любой иностранный язык. Во всяком случае старайтесь программировать таким образом, чтобы сообщений об ошибках никогда не возникало.

</BODY>
</HTML>
